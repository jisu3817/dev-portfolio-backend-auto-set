FROM node:14.5.0

WORKDIR /usr/server

COPY ./app/tsconfig.json .
COPY ./app/package.json .
COPY ./app/package-lock.json .
COPY ./app/.eslintrc.js .

RUN npm ci --production
RUN npm i -g nodemon
RUN npm i -g typescript
RUN tsc

COPY ./app/dist ./dist
COPY ./app/src/public ./dist/src/public

CMD ["npm", "start"]